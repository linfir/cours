\documentclass{yann}
\yann{layout=onecolumn,geometry={margin=2.5cm}}
\usepackage{booktabs}

\begin{document}
\title{Calcul de primitives}
\maketitle

Il y a longtemps, trÃ¨s longtemps, vous avez appris Ã  dÃ©river une fonction.
C'est utile, mais pas trÃ¨s amusant: il suffit de connaÃ®tre les dÃ©rivÃ©es usuelles et d'appliquer les rÃ¨gles sur les sommes, produits, quotients et composÃ©es.
C'est trÃ¨s mÃ©canique...

Primitiver une fonction, c'est une toute autre histoire.
Il faut toujours connaÃ®tre les primitives usuelles (c'est juste le tableau des dÃ©rivÃ©es, vu Ã  l'envers), et il y a encore une rÃ¨gle pour la somme.
En revanche, il n'y a pas de rÃ¨gle gÃ©nÃ©rale qui donne la primitive d'un produit, d'un quotient ou d'une composÃ©e.

Mais comment faire pour calculer une primitive?
Au fil du temps, on a trouvÃ© un certain nombre de mÃ©thodes\footnote{Une mÃ©thode, c'est une astuce qui sert au moins deux fois.} qui s'appliquent dans certains cas particuliers.
C'est d'ailleurs l'objet de ce chapitre.
AprÃ¨s, vous Ãªtes tout seuls.
Il faudra essayer, deviner, combiner les mÃ©thodes, trouver des astuces diaboliques, s'apercevoir que Ã§a ne marche pas, recommencer, recommencer encore...
Bref, c'est comme un puzzle, il faudra rÃ©flÃ©chir.

Existe-t-il une mÃ©thode ultime permettant de calculer tou\-tes les primitives?
Et Wolfram Alpha (ou Maple, Mathematica, Maxima, Sympy, Sage, etc.), au fait: la connaÃ®t-il?

Ã€ ces questions, la rÃ©ponse est NON; et ce non ne signifie pas Â«on a beaucoup cherchÃ©, et on n'a rien trouvÃ©Â», mais un bien plus fort Â«on a \emph{dÃ©montrÃ©} qu'il n'existe pas de mÃ©thode universelleÂ».
Certaines primitives \emph{ne peuvent pas} s'exprimer Ã  partir\footnote{Plus prÃ©cisÃ©ment, en partant des fonctions usuelles et en faisant un nombre fini de sommes, diffÃ©rences, produits, quotients ou compositions.} des fonctions usuelles.

Par exemple, si on demande $\DS âˆ«\frac{\D x}{\ln x}$ Ã  Wolfram Alpha, il rÃ©pondra \verb|li(x)|.
Or la fonction $\mathrm{li}$, dite logarithme intÃ©gral est par dÃ©finition.. une primitive de $1/\ln(x)$!
En un sens, c'est de la triche, mais il n'existe pas de meilleure rÃ©ponse.
Et si on lui demande une fonction assez compliquÃ©e comme
\[ âˆ«\frac{\sin^3\Pa{1+\frac{1}{\ln t}}}{\cos t + âˆš{e^t + 1}} \D t, \]
il ne rÃ©pondra rien.

\Para{Rappel}
Soit $I$ un intervalle de $â„$, et $f, F$ deux fonctions de $I$ dans $ğ•‚$.
On dit que $F$ est une primitive de $f$ sur $I$ si et seulement si
$F$ est dÃ©rivable sur $I$ et $F' = f$.
On note $âˆ« f = F + C^{\text{ste}}$.

\section{Fonctions usuelles}

\begingroup
  \def\Icos{$\intO{kÏ€-Ï€/2, kÏ€+Ï€/2}$ oÃ¹~$kâˆˆâ„¤$}
  \def\Isin{$\intO{kÏ€, (k+1)Ï€}$ oÃ¹~$kâˆˆâ„¤$}
  \def\IRs{$â„^*_-$, $â„^*_+$}
  \renewcommand\arraystretch{1.5}
  \begin{tabular}{ccc}
    \toprule
    Fonction $f$& Intervalle de dÃ©finition& Primitive de $f$\cr
    \midrule
    $f(x)$& $I$& $âˆ«f(x)\D x = F(x)$\cr
    $f(Î±x)$ oÃ¹ $Î±â‰ 0$& $I$& $\frac1Î±F(Î±x)$\cr
    \midrule
    $e^x$ & $â„$& $e^x$\cr
    $\ln x$ & $\Rps$ & $x\ln(x)-x$\cr
    \midrule
    $x^Î±$ oÃ¹ $Î±âˆˆâ„‚âˆ–\acco{-1}$& $\Rps$& $\frac{x^{Î±+1}}{Î±+1}$\cr
    $x^n$ oÃ¹ $nâˆˆâ„•$& $â„$& $\frac{x^{n+1}}{n+1}$\cr
    $x^n$ oÃ¹ $nâˆˆâ„¤$, $nâ‰¤-2$& \IRs& $\frac{x^{n+1}}{n+1}$\cr
    $x^{-1} = \frac1x$& \IRs& $\ln\Abs{x}$\cr
    \midrule
    $\cos x$& $â„$& $\sin x$\cr
    $\sin x$& $â„$& $-\cos x$\cr
    $\ch x$& $â„$& $\sh x$\cr
    $\sh x$& $â„$& $\ch x$\cr
    % $\tan x$& \Icos& $-\ln\abs{\cos x}$\cr
    % $\cotan x$& \Isin& $\ln\abs{\sin x}$\cr
    % $\th x$& $â„$& $\ln\ch x$\cr
    % $\coth x$& \IRs& $\ln\abs{\sh x}$\cr
    % \midrule
    $\frac{1}{\cos^2 x} = 1 + \tan^2 x$& \Icos& $\tan x$\cr
    % $\frac{1}{\sin^2 x} = 1 + \cotan^2 x$& \Isin& $-\cotan x$\cr
    % $\frac{1}{\ch^2 x} = 1 - \th^2 x$& $â„$& $\th x$\cr
    % $\frac{1}{\sh^2 x} = \coth^2 x - 1$& \IRs& $-\coth x$\cr
    \midrule
    $\frac{1}{1+x^2}$& $â„$& $\arctan x$\cr
    % $\frac{1}{1-x^2}$& $]-1,1[$& $\argth x$\cr
    % $\frac{1}{1-x^2}$& $]-âˆ,-1[$, $]-1,1[$, $]1,+âˆ[$& $\frac12\ln\Abs{\frac{1+x}{1-x}}$\cr
    % $\frac{1}{âˆš{1+x^2}}$& $â„$& $\argsh x = \ln\Pa{x+âˆš{x^2+1}}$\cr
    % $\frac{1}{âˆš{1-x^2}}$& $]-1,1[$& $\arcsin x$ ou  $-\arccos x$\cr
    % $\frac{1}{âˆš{x^2-1}}$& $]1,+âˆ[$& $\argch x = \ln\Pa{x+âˆš{x^2-1}}$\cr
    % $\frac{1}{âˆš{x^2-1}}$& $]-âˆ,-1[$, $]1,+âˆ[$& $\ln\Abs{x+âˆš{x^2-1}}$\cr
    % \midrule
    $\frac{1}{a^2+x^2}$ oÃ¹ $a âˆˆâ„^*$& $â„$& $\frac1a \arctan\Pafrac xa$\cr
    % $\frac{1}{a^2-x^2}$ oÃ¹ $a > 0$& $]-âˆ,-a[$, $]-a,a[$, $]a,+âˆ[$& $\frac1{2a} \ln\Abs{\frac{a+x}{a-x}}$\cr
    % $\frac{1}{âˆš{a^2+x^2}}$ oÃ¹ $a âˆˆ\Rs$& $â„$& $\argsh\Pafrac xa$\cr
    % $\frac{1}{âˆš{a^2-x^2}}$ oÃ¹ $a > 0$& $]-a,a[$& $\arcsin\Pafrac xa$ ou $-\arccos\Pafrac xa$\cr
    % $\frac{1}{âˆš{x^2-a^2}}$ oÃ¹ $a > 0$& $]-âˆ,-a[$, $]a,+âˆ[$& $\argch\Pafrac xa$\cr
    \bottomrule
  \end{tabular}
\endgroup

\yann{displaystyle}

\section{MÃ©thodes gÃ©nÃ©rales}

\subsection{Changement de variables}

Soit $f$ une fonction de classe $\CC0$ et $Ï•$ de classe $\CC1$.
Le changement de variable $x = Ï•(y)$ s'Ã©crit:
\[ âˆ« f(x) \D x = âˆ« f(Ï•(y)) Ï•'(y) \D y \]

Si l'on souhaite faire un changement de variables \enquote{dans l'autre sens}, Â£cad. de la forme $y = Ïˆ(x)$,
on doit s'assurer que $Ïˆ$ est bijective et que $Ïˆ^{-1}$ est de classe $\CC1$;
cela est garanti si $Ïˆ$ est une bijection de classe $\CC1$ dont la dÃ©rivÃ©e ne s'annule pas.

\Para{Exemples}
$âˆ«\frac{\D x}{x^2 + a^2}$,
$âˆ«\tan x \D x$,
$âˆ«\frac{\arcsin x}{âˆš{1-x^2}} \D x$,
$âˆ«\frac{\D x}{âˆš{1+âˆš{1+x}}}$.

\subsection{IntÃ©gration par parties}

Si $f$ est de classe $\CC0$ et $g$ est de classe $\CC1$, on a:
\[ âˆ«fg = Fg - âˆ«Fg' \qquad \text{ oÃ¹ } F = âˆ«f \]

\Para{Exemples}
$âˆ«\ln x \D x$,
$âˆ«\arcsin x \D x$,
$âˆ«\ln\Pa{1+x^2} \D x$,
$âˆ«\frac{x \D x}{\cos^2 x}$.

\subsection{GÃ©nÃ©ralisation: intÃ©gration par parties multiple}

Si $f$ et $g$ sont de classe $\CC n$:

\begin{align*}
  âˆ« f^{(n)} g
  &= âˆ‘_{k=0}^{n-1} (-1)^k f^{(n-1-k)} g^{(k)} + (-1)^n âˆ«fg^{(n)} \\
  &= f^{(n-1)} g - f^{(n-2)}g' + f^{(n-3)}g'' - f^{(n-4)}g^{(3)} + \cdots
  + (-1)^{n-1} f g^{(n-1)} + (-1)^n âˆ«fg^{(n)}
\end{align*}

\Para{Exemples}
$âˆ«(x^3 + x^2 + 1) e^x \D x$,
$âˆ«_{-1}^1 (1-x^2)^n \D x$.

\section{Fonctions polynÃ´me-exponentielle}

\subsection{$âˆ«P(x) e^{Î±x} \D x$}

On suppose $P âˆˆâ„‚[X]$, $Î±âˆˆâ„‚^*$. Soit $d$ le degrÃ© de $P$.
On dispose de deux mÃ©thodes:
\begin{itemize}
\item
  intÃ©gration par parties: on effectue $d$ intÃ©grations par parties (ou une intÃ©gration par parties multiple) en dÃ©rivant le polynÃ´me et en primitivant l'exponentielle;
\item
  identification (prÃ©fÃ©rable quand $d â‰¥3$): on cherche $Q âˆˆâ„‚_d[X]$ tel que \[ âˆ«P(x) e^{Î±x} \D x = Q(X) e^{Î±x} + C, \] Â£cad. $Î±Q(X) + Q'(X) = P(X)$.
\end{itemize}

\Para{Exemple}
$âˆ«(x^2-x+3) e^{2x} \D x$.

\subsection{$âˆ«e^{Î±x} \cos(Î²x) \D x$}

On suppose $(Î±,Î²) âˆˆâ„^2 âˆ–\Acco{(0,0)}$.
On calcule $âˆ«e^{(Î±+ iÎ²) x} \D x$, et l'on sÃ©pare partie rÃ©elle et partie imaginaire.

\Para{Exemple}
$âˆ«e^{2x} \sin{3x} \D x$.

\subsection{$âˆ«P(x) \cos(Î²x) \D x$}

On suppose $P âˆˆâ„_d[X]$, $Î²âˆˆâ„^*$.
On dispose de trois mÃ©thodes:
\begin{itemize}
\item
  intÃ©gration par parties;
\item
  identification: on cherche $âˆ«P(x) \cos(Î²x) \D x$ sous la forme $A(x) \cos(Î²x) + B(x) \sin(Î²x)$ oÃ¹ $(A,B) âˆˆâ„_d[X]^2$;
\item
  passage par l'exponentielle complexe: on commence par calculer $âˆ«P(x) e^{iÎ²x} \D x$.
\end{itemize}

\Para{Exemple}
$âˆ«x^3 \sin x \D x$.

\subsection{$âˆ«P(x) e^{Î±x} \cos(Î²x) \D x$}

On suppose $P âˆˆâ„[X]$, $(Î±,Î²) âˆˆâ„^2 âˆ–\Acco{(0,0)}$.
On dispose de deux mÃ©thodes:
\begin{itemize}
\item
  passage Ã  l'exponentielle complexe puis intÃ©gration par parties;
\item
  identification.
\end{itemize}

\Para{Exemple}
$âˆ«x^3 e^x \cos x \D x$.

\section{Fonctions rationnelles}

Pour toute fonction rationnelle $R âˆˆâ„(X)$ dont on sait factoriser le dÃ©nominateur, on dispose d'un algorithme permettant de calculer $âˆ«R(x) \D x$.

\Para{Astuce}
Si $R$ est impaire, on peut Ã©crire \[ R(X) = X \frac{P(X^2)}{Q(X^2)}, \] de sorte que si l'on fait le changement de variables $y=x^2$, on a \[ âˆ«R(x) \D x = \frac12 âˆ«\frac{P(y)}{Q(y)} \D y. \]
Il reste Ã  intÃ©grer $S(Y) = \frac{P(Y)}{Q(Y)}$, qui est plus simple que $R$.
Ainsi, on a abaissÃ© le degrÃ© et donc simplifiÃ© le calcul.

\subsection{DÃ©composition en Ã©lÃ©ments simples}

\Para{Exemples}[pÃ´les simples rÃ©els]
\[ \frac{1}{X^2-1}, \quad
  \frac{X+1}{X+2}, \quad
\frac{2X+8}{X^2+8X+15}, \]
\[ \frac{X^4+X+1}{X(X^2-1)}, \quad
\frac{X^5+6X^4+9X^3+6}{X(X+1)(X+2)(X+3)}. \]

\Para{Exemples}[pÃ´les multiples rÃ©els]
\[ \frac{1}{X^2(X+1)}, \quad \frac{X^3+2}{(X^2-1)^2}. \]

\Para{Exemples}[pÃ´les simples complexes]
\[ \frac{1}{X(X^2+1)}, \quad
  \frac{-X^3+2X^2+1}{X^3+X}, \quad
\frac{2X^3-4X+2}{X^3+2X}. \]

\Para{Exemple}[pÃ´les multiples complexes]
\[ \frac{X^3+3X+1}{X^5+2X^3+X}. \]

\subsection{Ã‰lÃ©ments simples de premiÃ¨re espÃ¨ce}

On cherche Ã  calculer \[ âˆ«\frac{c}{(ax+b)^n} \D x. \]
Ce cas est trÃ¨s facile.
Attention toutefois au cas $n = 1$ si $(a,b) âˆ‰â„^2$: il faut alors multiplier par la quantitÃ© conjuguÃ©e et se ramener Ã  un Ã©lÃ©ment simple de seconde espÃ¨ce.

\subsection{Ã‰lÃ©ments simples de seconde espÃ¨ce}

On cherche Ã  calculer \[ âˆ«\frac{dx+e}{(ax^2+bx+c)^n} \D x, \]
oÃ¹ $(a,b,c)âˆˆâ„^3$, $aâ‰ 0$, $Î”=b^2-4ac<0$.

On procÃ¨de par Ã©tapes.

\subsubsection{PremiÃ¨re Ã©tape}

On effectue le changement de variables $y = x+\frac{b}{2a}$, de sorte que
\[ âˆ«\frac{dx+e}{(ax^2+bx+c)^n} \D x = âˆ«\frac{dy+e'}{(ay^2+c')^n} \D y. \]
Notons que l'on a nÃ©cessairement $c'>0$.

\subsubsection{DeuxiÃ¨me Ã©tape}

On sÃ©pare l'intÃ©grale en deux, de sorte que l'on doit calculer:
\begin{itemize}
\item
  $I = âˆ«\frac{dy}{(ay^2+c')^n} \D y$, qui est immÃ©diate Ã  calculer, car l'intÃ©grande est de la forme $\frac{u'}{u^n}$;
\item
  $J = âˆ«\frac{e'}{(ay^2+c')^n} \D y$, qui se ramÃ¨ne immÃ©diatement Ã  $K = âˆ«\frac{\D y}{(y^2+Î±^2)^n}$.
\end{itemize}

\subsubsection{TroisiÃ¨me Ã©tape}

Si $n=1$, c'est gagnÃ©, on connaÃ®t une primitive:
\[ \frac{1}{Î±}\arctan\Pafrac{y}{Î±}. \]
Sinon, on fait le changement de variables $y=tÎ±$, de faÃ§on Ã  se ramener Ã 
\[ J_n = âˆ«\frac{\D t}{(t^2+1)^n}. \]
Avec une intÃ©gration par parties, on Ã©tablit une relation de rÃ©currence entre les $J_n$ permettant
de calculer $J_2$, $J_3$, etc...

\subsubsection{Conclusion} On exprime en fonction de la variable initiale, puis on regroupe le tout.

\Para{Exemples}
$âˆ«\frac{\D x}{x(x^2+1)^3}$,
$âˆ«\frac{x^3 \D x}{x^2+2x+2}$,
$âˆ«\frac{\D x}{x^3+1}$.

% -----------------------------------------------------------------------------
\section{Fonctions de la forme $R(\cosÎ¸,\sinÎ¸)$}
On suppose $R âˆˆâ„(X,Y)$.

\subsection{Cas particulier: $âˆ«\cos^m Î¸\sin^n Î¸\D Î¸$}

On a une mÃ©thode qui marche toujours: linÃ©ariser.
Cependant, on peut parfois Ãªtre plus malin.
Si $m$ est impair, on peut poser $x = \sin Î¸$;
si $n$ est impair, on peut poser $x = \cos Î¸$.

\Para{Exemple}
$âˆ«\sin^7 Î¸\cos^4 Î¸\D Î¸$.

\subsection{Cas gÃ©nÃ©ral}

On a une mÃ©thode qui marche toujours: la tangente de l'arc moitiÃ©, Â£cad. le changement de variable $x = \tan\frac{Î¸}{2}$.
Cela nous ramÃ¨ne Ã  primitiver une fraction rationnelle, mais les calculs sont souvent horribles.
On peut Ãªtre plus malin.

La \emph{rÃ¨gle de Bioche} rÃ©pond au problÃ¨me.
On forme l'Ã©lÃ©ment diffÃ©rentiel $Ï‰(Î¸) = R(\cosÎ¸,\sinÎ¸) \D Î¸$.
\begin{itemize}
\item
  si $Ï‰(-Î¸)  = Ï‰(Î¸)$, alors on pose $x = \cosÎ¸$;
\item
  si $Ï‰(Ï€-Î¸) = Ï‰(Î¸)$, alors on pose $x = \sinÎ¸$;
\item
  si $Ï‰(Ï€+Î¸) = Ï‰(Î¸)$, alors on pose $x = \tanÎ¸$;
\item
  sinon, on pose $x = \tan\frac{Î¸}{2}$.
  Rappel: on a alors $\sinÎ¸= \frac{2x}{1+x^2}$ et $\cosÎ¸=\frac{1-x^2}{1+x^2}$.
\end{itemize}
Dans tous les cas, on se ramÃ¨ne alors Ã  primitiver une fraction rationnelle.

\Para{Exemple}
$âˆ« \frac{\sin^2 x}{2+\cos x} \D x$,
$âˆ« \frac{\D x}{2+\cos x}$.

\subsection{Fonctions de la forme $R(\chÎ¸, \shÎ¸)$}
On suppose $R âˆˆâ„(X,Y)$.

Il suffit d'appliquer la rÃ¨gle de Bioche Ã  $R(\cosÎ¸, \sinÎ¸)$, puis:
\begin{itemize}
\item
  au lieu de poser $x = \cosÎ¸$, on pose $x = \chÎ¸$;
\item
  au lieu de poser $x = \sinÎ¸$, on pose $x = \shÎ¸$;
\item
  au lieu de poser $x = \tanÎ¸$, on pose $x = \thÎ¸$;
\item
  au lieu de poser $x = \tan\fracÎ¸2$, on pose $x = \th\fracÎ¸2$ ou bien $x = e^Î¸$.
\end{itemize}

\Para{Exemple}
$âˆ«\frac{\sh^2 x}{\ch x(2\sh^3 x + 3\ch^3 x)} \D x$.

% -----------------------------------------------------------------------------
\section{Fonctions de la forme $R\Pa{e^{Î±x}}$}
On suppose $R âˆˆâ„(X)$.
On pose $y = e^{Î±x}$.

\Para{Exemple}
$âˆ«\frac{\D x}{(e^x + 2)^2}$.

Le mÃªme changement marche parfois mÃªme si $R$ n'est pas rationnelle, par exemple pour:
$âˆ«âˆš{e^x + 1} \D x$.

% -----------------------------------------------------------------------------
\section{Fonctions de la forme $R\Pa{x,âˆš[n]{\frac{ax+b}{cx+d}}}$}
On suppose $R âˆˆâ„(X,Y)$.
On pose $y = âˆš[n]{\frac{ax+b}{cx+d}}$.

\Para{Exemples}
$âˆ«âˆš{\frac{x}{(1-x)^3}} \D x$,
$âˆ«\frac{1}{âˆš{x}+âˆš{x+1}}$,
$âˆ«{\frac{\D x}{âˆš{x} + âˆš[3]{x}}}$.

% -----------------------------------------------------------------------------
\section{IntÃ©grales abÃ©liennes $R\Pa{x, âˆš{ax^2+bx+c}}$}
On suppose $R âˆˆâ„(X,Y)$.

Notons $Î”= b^2 - 4ac$.
\begin{itemize}
\item
  $Î”= 0$: la racine carrÃ©e disparaÃ®t, il ne reste qu'une valeur absolue,
  qui disparait Ã©galement si on restreint l'intervalle.
\item
  $a<0$, $Î”<0$: impossible car $âˆ€x âˆˆâ„$, $ax^2+bx+c < 0$.
\item
  $a>0$, $Î”<0$: par un changement de variable affine,
  on se ramÃ¨ne Ã  $G(t,âˆš{1+t^2})$, puis on pose $t = \shÎ¸$.
\item
  $a<0$, $Î”>0$: par un changement de variable affine,
  on se ramÃ¨ne Ã  $G(t,âˆš{1-t^2})$, puis on pose $t = \sinÎ¸$ ou $t = \cosÎ¸$.
\item
  $a>0$, $Î”>0$: par un changement de variable affine,
  on se ramÃ¨ne Ã  $G(t,âˆš{t^2-1})$, puis on pose $t = \chÎ¸$.
\end{itemize}

\Para{Exemple}
$âˆ«\frac{x \D x}{âˆš{x^2+x+1}}$,
$âˆ«\frac{x \D x}{1 + âˆš{x^2+x+1}}$.

%\end{multicols}
\newpage

\end{document}
